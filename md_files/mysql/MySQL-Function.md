# MySQL 常用函数
## 1. 字符串函数

|         函数          |                             功能                             |
| :-------------------: | :----------------------------------------------------------: |
| concat(s1,s2,...,sn)  |                 连接s1,s2,...,sn为一个字符串                 |
| insert(str,x,y,instr) | 将字符串str从第x位置开始，y个字符长的子串替换为字符串instr（位置从1开始） |
|      lower(str)       |                将字符串str中的字符转换成小写                 |
|      upper(str)       |                将字符串str中的字符转换成大写                 |
|      left(str,x)      |                    返回str最左边的x个字符                    |
|     right(str,x)      |                    返回str最右边的x个字符                    |
|    lpad(str,n,pad)    |    用字符串pad对str最左边进行填充，直到长度为n个字符长度     |
|    rpad(str,n,pad)    |    用字符串pad对str最右边进行填充，直到长度为n个字符长度     |
|      ltrim(str)       |                        去掉左侧的空格                        |
|      rtrim(str)       |                        去掉右侧的空格                        |
|       trim(str)       |                        去掉两侧的空格                        |
|     repeat(str,n)     |                  返回字符串str重复n次的结果                  |
|   replace(str,a,b)    |                   用b替换str中所有出现的a                    |
|     strcmp(s1,s2)     |              比较两个字符串s1,s2。返回1，0，-1               |
|  substring(str,x,y)   |  返回从字符串str的x位置起的y个字符长度的子串（位置从1开始）  |



## 2. 数值函数

|     函数      |                功能                |
| :-----------: | :--------------------------------: |
|    abs(x)     |               绝对值               |
|    ceil(x)    | 返回大于x的最小整数值，即向上取整  |
|   floor(x)    | 返回小于x的最大整数值，即向下取整  |
|   mod(x,y)    |              x对y取余              |
|    rand()     |         返回0~1内的随机值          |
|  round(x,y)   | 返回参数x的四舍五入的有y位小数的值 |
| truncate(x,y) |    返回数字x截断为y位小数的结果    |

eg.

```mysql
mysql> select ceil(1.2), floor(1.2);
+-----------+------------+
| ceil(1.2) | floor(1.2) |
+-----------+------------+
|         2 |          1 |
+-----------+------------+
1 row in set (0.00 sec)

mysql> select ceil(-1.2), floor(-1.2);
+------------+-------------+
| ceil(-1.2) | floor(-1.2) |
+------------+-------------+
|         -1 |          -2 |
+------------+-------------+
1 row in set (0.00 sec)

mysql> select rand(), ceil(100*rand());
+--------------------+------------------+
| rand()             | ceil(100*rand()) |
+--------------------+------------------+
| 0.6494681040285789 |               24 |
+--------------------+------------------+
1 row in set (0.00 sec)

mysql> select round(1.2345,2), round(1.456, 2);
+-----------------+-----------------+
| round(1.2345,2) | round(1.456, 2) |
+-----------------+-----------------+
|            1.23 |            1.46 |
+-----------------+-----------------+
1 row in set (0.00 sec)

mysql> select round(1.2345,6), round(1.456, 6);
+-----------------+-----------------+
| round(1.2345,6) | round(1.456, 6) |
+-----------------+-----------------+
|        1.234500 |        1.456000 |
+-----------------+-----------------+
1 row in set (0.00 sec)

mysql> select strcmp('bb', 'aa'), strcmp('bb', 'bb'), strcmp('bb', 'cc');
+--------------------+--------------------+--------------------+
| strcmp('bb', 'aa') | strcmp('bb', 'bb') | strcmp('bb', 'cc') |
+--------------------+--------------------+--------------------+
|                  1 |                  0 |                 -1 |
+--------------------+--------------------+--------------------+
1 row in set (0.00 sec)

mysql> select truncate(1.2345, 3), truncate(1.2345, 6);
+---------------------+---------------------+
| truncate(1.2345, 3) | truncate(1.2345, 6) |
+---------------------+---------------------+
|               1.234 |            1.234500 |
+---------------------+---------------------+
1 row in set (0.00 sec)
```



## 3. 日期和时间函数



|               函数                |             功能             |
| :-------------------------------: | :--------------------------: |
|             curdate()             |         返回当前日期         |
|             curtime()             |         返回当前时间         |
|               now()               |      返回当前日期和时间      |
|       unix_timestamp(date)        |   返回日期date的unix时间戳   |
|       from_unixtime(stamp)        |   返回时间戳stamp的日期值    |
|            week(date)             | 返回日期date为一年中的第几周 |
|            year(date)             |        返回date的年份        |
|            hour(time)             |       返回time的小时值       |
|           minute(time)            |       返回time的分钟值       |
|          monthname(date)          |       显示date的月份名       |
|       date_format(date,fmt)       |          格式化日期          |
| date_add(date,INTERVAL expr type) |                              |
|       datediff(expr,expr2)        |                              |
|                                   |                              |
|                                   |                              |

eg.

```mysql
mysql> select curdate();
+------------+
| curdate()  |
+------------+
| 2018-10-27 |
+------------+
1 row in set (0.00 sec)

mysql> select curtime();
+-----------+
| curtime() |
+-----------+
| 21:45:00  |
+-----------+
1 row in set (0.00 sec)

mysql> select now();
+---------------------+
| now()               |
+---------------------+
| 2018-10-27 21:45:22 |
+---------------------+
1 row in set (0.00 sec)

mysql> select unix_timestamp(now());
+-----------------------+
| unix_timestamp(now()) |
+-----------------------+
|            1540648073 |
+-----------------------+
1 row in set (0.00 sec)

mysql> select from_unixtime(1540648073);
+---------------------------+
| from_unixtime(1540648073) |
+---------------------------+
| 2018-10-27 21:47:53       |
+---------------------------+
1 row in set (0.00 sec)

mysql> select week(now());
+-------------+
| week(now()) |
+-------------+
|          42 |
+-------------+
1 row in set (0.00 sec)

mysql> select year(now());
+-------------+
| year(now()) |
+-------------+
|        2018 |
+-------------+
1 row in set (0.00 sec)

mysql> select hour(now());
+-------------+
| hour(now()) |
+-------------+
|          22 |
+-------------+
1 row in set (0.00 sec)

mysql> select minute(now());
+---------------+
| minute(now()) |
+---------------+
|             4 |
+---------------+
1 row in set (0.00 sec)

mysql> select monthname(now());
+------------------+
| monthname(now()) |
+------------------+
| October          |
+------------------+
1 row in set (0.00 sec)
```

**date_format(date, fmt):**

按照字符串fmt 格式化日期 date 值，此函数能够按指定的格式显示日期，可以用到的格式符如下表显示：

|    格式符     |                           格式说明                           |
| :-----------: | :----------------------------------------------------------: |
|    %S和%s     |                两位数字形式的秒(00,01,...,59)                |
|      %i       |                两位数字形式的分(00,01,...,59)                |
|      %H       |           两位数字形式的小时，24小时(00,01,...,23)           |
| %h和%I(大写i) |           两位数字形式的小时，12小时(01,02,...,12)           |
|      %k       |              数字形式的小时，24小时(0,1,...,23)              |
|   %l(小写L)   |              数字形式的小时，12小时(1,2,...,12)              |
|      %T       |                  24小时的时间形式(hh:mm:ss)                  |
|      %r       |           12小时的时间格式(hh:mm:ssAM或hh:mm:ssPM)           |
|      %p       |                           AM 或 PM                           |
|      %W       |        一周中每一天的名称(Sunday,Monday,...,Saturday)        |
|      %a       |           一周中每一天名称的缩写(Sun,Mon,...,Sat)            |
|      %w       |  以数字形式表示周中的天数(0=Sunday,1=Monday,...,6=Saturday)  |
|      %d       |              两位数字表示月中的天数(01,...,31)               |
|      %e       |              数字形式表示月中的天数(1,2,...,31)              |
|      %D       |           英文后缀表示月中的天数(1st,2nd,3rd,...)            |
|      %j       |           以3位数字表示年中的天数(001,002,...,366)           |
|      %U       | 一年中的第几周(00,01,...,52)，其中Sunday为周中的第一天。（从00开始） |
|      %u       | 一年中的第几周(01,02,...,53)，其中Monday为周中的第一天。（从01开始） |
|      %M       |             月名(January,February,...,December)              |
|      %b       |                 缩写的月名(Jan,Feb,...,Dec)                  |
|      %m       |               两位数字表示的月份(01,02,...,12)               |
|      %c       |                  数字表示的月份(1,2,...,12)                  |
|      %Y       |                   4位数字表示的年份(2018)                    |
|      %y       |                    两位数字表示的年份(18)                    |

eg.



```mysql
mysql> select date_format(now(), '%M, %D, %Y');
+----------------------------------+
| date_format(now(), '%M, %D, %Y') |
+----------------------------------+
| October, 27th, 2018              |
+----------------------------------+
1 row in set (0.00 sec)
```

**时间：**

```mysql
mysql> select date_format(now(), '%H:%i:%S, %H:%i:%s');
+------------------------------------------+
| date_format(now(), '%H:%i:%S, %H:%i:%s') |
+------------------------------------------+
| 23:27:02, 23:27:02                       |
+------------------------------------------+
1 row in set (0.00 sec)

mysql> select date_format(now(), '%h:%i:%S %p, %I:%i:%S %p');
+------------------------------------------------+
| date_format(now(), '%h:%i:%S %p, %I:%i:%S %p') |
+------------------------------------------------+
| 11:27:54 PM, 11:27:54 PM                       |
+------------------------------------------------+
1 row in set (0.00 sec)

mysql> select date_format(now(), '%k:%i:%S, %l:%i:%S %p');
+---------------------------------------------+
| date_format(now(), '%k:%i:%S, %l:%i:%S %p') |
+---------------------------------------------+
| 23:28:57, 11:28:57 PM                       |
+---------------------------------------------+
1 row in set (0.00 sec)

mysql> select date_format(now(), '%T, %r');
+------------------------------+
| date_format(now(), '%T, %r') |
+------------------------------+
| 23:29:32, 11:29:32 PM        |
+------------------------------+
1 row in set (0.00 sec)
```



**星期几：**

```mysql
mysql> select date_format(now(), '%W %a %w');
+--------------------------------+
| date_format(now(), '%W %a %w') |
+--------------------------------+
| Saturday Sat 6                 |
+--------------------------------+
1 row in set (0.00 sec)
```

**日期天数：**

```mysql
mysql> select date_format(now(), '%d, %e, %D');
+----------------------------------+
| date_format(now(), '%d, %e, %D') |
+----------------------------------+
| 27, 27, 27th                     |
+----------------------------------+
1 row in set (0.00 sec)
```

**第几天和第几周：**

```mysql
mysql> select date_format('2018-01-01', '%j, %U, %u, %W');
+---------------------------------------------+
| date_format('2018-01-01', '%j, %U, %u, %W') |
+---------------------------------------------+
| 001, 00, 01, Monday                         |
+---------------------------------------------+
1 row in set (0.00 sec)

mysql> select date_format('2018-12-31', '%j, %U, %u, %W');
+---------------------------------------------+
| date_format('2018-12-31', '%j, %U, %u, %W') |
+---------------------------------------------+
| 365, 52, 53, Monday                         |
+---------------------------------------------+
1 row in set (0.00 sec)
```

**月份名：**

```mysql
mysql> select date_format('2018-01-01', '%M, %b, %m, %c');
+---------------------------------------------+
| date_format('2018-01-01', '%M, %b, %m, %c') |
+---------------------------------------------+
| January, Jan, 01, 1                         |
+---------------------------------------------+
1 row in set (0.00 sec)
```

**年份：**

```mysql
mysql> select date_format('2018-01-01', '%Y, %y');
+-------------------------------------+
| date_format('2018-01-01', '%Y, %y') |
+-------------------------------------+
| 2018, 18                            |
+-------------------------------------+
1 row in set (0.00 sec)
```



